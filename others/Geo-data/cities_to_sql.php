<?php
// $file = "cities.txt";
// $file_w = "cities.sql";
// $f = fopen($file, "r");
// $nf = fopen($file_w, "w+");

// for($l = 0; $l<10; $l++){
   
//     $line = fgets($f);
//     echo $line;
//     $subs = substr($line, +2);
//     // var_dump($subs);
//     // die();
//     // $ex = preg_split('/\s+/', $line);
//     // print_r($ex);

//     $ex = explode('  ', $line);


// var_dump($ex);
// die();



//     foreach($ex as $k=>$v){
//         // echo $k.' '.$v.' ';
// // var_dump($v);
//         // echo $k.' <br>';
//         // echo '<br>';

//         $fw = fwrite($nf, "('" . $v . "','"  . $v . "')\r\n");

//     }
// }




// fclose($f);
// fclose($nf);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// $file = "cities.txt";
// $file_w = "cities.sql";

// $f = fopen($file, "r");
// $nf = fopen($file_w, "w");

// while ($line = fgets($f, 1))  {
   
//     $ex = preg_split('/\s+/', $line);
//    // var_dump($ex);die();
//     foreach($ex){
//         echo $ex[0].' '. $ex[1];
//         echo '<br>';

//         fwrite($nf, "('" . $ex[0] . "','"  . $ex[1] . "')\r\n");die():

//     }
// }



// fclose($f);
// fclose($nf);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
set_time_limit ( 0 );
$infile = "cities.txt";
$outfile = "cities.csv";
$rh = fopen($infile, "r");
$wh = fopen($outfile, "w+");

//this has to change because a blank line or a line that is simply '0' will break the loop
while( ($line1 = fgets($rh, 4096000)) !== false ) {
    $line = substr($line1, 0, -2);
    $parts = preg_split('/\s+/', $line, 2); //limit to splitting into TWO parts, state and city.
    $state = $parts[0];
    $city = preg_replace("/'/", '&#39;', $parts[1]); //replace stray apostrophes
    $output = sprintf("%s,%s\r\n", $state, $city);
    fwrite($wh, $output);
}

fclose($rh);
fclose($wh);
echo "ok";















?>
